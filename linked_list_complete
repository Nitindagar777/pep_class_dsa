#include<bits/stdc++.h>
using namespace std;

class Node{
public:
    int data;
    Node* next;
    Node(int val){
        data = val;
        next = NULL;
    }
};

class LL{
public:
    Node* head;
    Node* tail;
    LL(){
        head = NULL;
        tail = NULL;
    }

    void push_front(int val){
        Node* newNode = new Node(val);

        if(head == NULL){
            head = tail = newNode;
        }else{
            newNode->next = head;
            head = newNode;
        }
    }

    void push_back(int val){
        Node* newNode = new Node(val);

        if(head == NULL){
            head = tail = newNode;
        }else{
            tail->next = newNode;
            tail = newNode;
        }
    }
    void printList(){
        Node* temp = head;
        while(temp != NULL){
            cout << temp->data << " -> ";
            temp = temp->next;
        }
        cout << "NULL\n";
    }

    void insert(int val, int pos){
        Node* newNode = new Node(val);
        Node* temp = head;
        if(temp == NULL){
            cout << "invalid" << "\n";
        }
        for(int i=0; i< pos - 1; i++){
            temp = temp->next;
        }
        newNode->next = temp->next;
        temp->next = newNode;
    }

    void pop_front(){
        Node* temp = head;
        head = head->next;
        temp->next = NULL;
        delete temp;
    }

    void pop_back(){
        Node* temp = head;
        while (temp->next->next != NULL)
        {
            temp = temp->next;
        }
        temp->next = NULL;
        delete tail;
        tail = temp;    
    }

    int searchItr(int key){
        Node* temp = head;
        int idx = 0;
        while(temp != NULL){
            if(temp->data == key){
                return idx;
            }
            temp = temp->next;
            idx++;
        }
        return -1;
    }

    int helper(Node* temp, int key){
        if(temp == NULL){
            return -1;
        }
        if(temp->data == key){
            return 0;
        }
        int idx = helper(temp->next, key);
        if(idx == -1){
            return -1;
        }
        return idx+1;
    }

    int searchRec(int key){
        return helper(head, key);
    }

    void reverse(){
        Node* curr = head;
        Node* prev = NULL;
        tail = head;
        while(curr != NULL){
            Node* next = curr->next;
            curr->next = prev;
            prev = curr;
            curr = next;
        }
        head = prev;
    }

    int getSize(){
        Node* temp = head;
        int count = 0;
        while(temp != NULL){
            temp = temp->next;
            count++;
        }
        return count;
    }

    void deleteNthFromEnd(int n){
        int size = getSize();
        Node* prev = head;

        for(int i=1; i<(size - n); i++){
            prev = prev->next;
        }
        cout << "deleted node = " << prev->next->data << "\n";
        prev->next = prev->next->next;
    }

};

bool cycleCheck(Node* head){
    Node* slow = head;
    Node* fast = head;

    while(fast != NULL && fast->next != NULL){
        slow = slow->next;
        fast = fast->next->next;
        if(slow == fast){
            cout << "cycle exist\n";
            return true;
        }
    }
    cout << "cycle not exist\n";
    return false;
}

void removeCycle(Node* head){
    // detect cycle 
    Node* slow = head;
    Node* fast = head;
    bool cycle = false;

    while(fast != NULL && fast->next != NULL){
        slow = slow->next;
        fast = fast->next->next;
        if(slow == fast){
            cout << "cycle detect\n";
            cycle = true;
            break;
        }
    }

    if(!cycle){
        cout << "cycle not exist\n";
        return;
    }

    // 2nd
    slow = head;

    // special
    if(slow == fast){
        while(fast->next != slow){
            fast = fast->next;
        }
        fast->next = NULL;
    }else{
        Node* prev = fast;
        while(slow != fast){
            slow = slow->next;
            prev = fast;
            fast = fast->next;
        }
        prev->next = NULL;
    }
}

Node* splitAtMid(Node* head){
    Node* slow = head;
    Node* fast = head;
    Node* prev = NULL;

    while(fast != NULL && fast->next != NULL){
        prev = slow;
        slow = slow->next;
        fast = fast->next->next;
    }
    if(prev != NULL){
        prev->next = NULL;
    }

    return slow;
}

Node* merge(Node* left, Node* right){
    LL ans;
    Node* i = left;
    Node* j = right;

    while(i != NULL && j != NULL){
        if(i->data <= j->data){
            ans.push_back(i->data);
            i = i->next;
        }else{
            ans.push_back(j->data);
            j = j->next;
        }
    }

    while(i != NULL){
        ans.push_back(i->data);
        i = i->next;
    }

    while(j != NULL){
        ans.push_back(j->data);
        j = j->next;
    }

    return ans.head;
}

Node* mergeSort(Node* head){

    if(head == NULL || head->next == NULL){
        return head;
    }

    Node* rightHead = splitAtMid(head);
    Node* left = mergeSort(head);
    Node* right = mergeSort(rightHead);
    return merge(left, right);
}
// zig-zag linked list

Node* reverseforhead(Node* head){
    Node* curr = head;
    Node* prev = NULL;
    while(curr != NULL){
        Node* next = curr->next;
        curr->next = prev;
        prev = curr;
        curr = next;
    }
    return prev;
}

Node* zigZagll(Node* head){

    Node* righthead = splitAtMid(head);
    Node* rightheadRev = reverseforhead(righthead);
    // merging
    Node* left = head;
    Node* right = rightheadRev;
    Node* nextLeft = NULL;
    Node* nextRight = NULL;
    Node* tail = right;
    while(left != NULL && right != NULL){
        nextLeft = left->next;
        nextRight = right->next;
        left->next = right;
        right->next = nextLeft;
        tail = right;
        left = nextLeft;
        right = nextRight;
    }
    if(right != NULL){
        tail->next = right;
    }  
    return head; 
} 



int main(){

    LL ll;
    // ll.push_front(3);
    // ll.push_front(2);
    // ll.push_front(1);
    // ll.printList();

    // ll.push_back(4);
    // ll.push_back(5);
    // ll.printList();

    // ll.insert(100,2);
    // ll.printList();

    // ll.pop_front();
    // ll.printList();

    // cout << ll.searchItr(100);
    // cout << endl;

    // ll.reverse();
    // ll.printList();

    // ll.deleteNthFromEnd(2);
    // ll.printList();

    // ll.push_front(4);
    // ll.push_front(3);
    // ll.push_front(32);
    // ll.push_front(1);
    // ll.push_front(5);
    // ll.push_front(8);
    // ll.push_front(11);
    // ll.tail->next = ll.head;

    // cycleCheck(ll.head);
    // removeCycle(ll.head);
    // ll.printList();

    // ll.head = mergeSort(ll.head);
    // ll.printList();

    ll.push_front(7);
    ll.push_front(6);
    ll.push_front(5);
    ll.push_front(4);
    ll.push_front(3);
    ll.push_front(2);
    ll.push_front(1);
    ll.printList();

    ll.head = zigZagll(ll.head);
    ll.printList();
    

    return 0;
}



// liked list by stl;

// #include <bits/stdc++.h>
// #include <list>
// #include <iterator>
// using namespace std;

// void printll(list<int> ll){
//     list<int> :: iterator itr;
//     for(itr = ll.begin(); itr != ll.end(); itr++){
//         cout << (*itr) << " -> ";
//     }
//     cout << "NULL\n";
// }

// int main(){

//     list<int> ll;
//     ll.push_front(1);
//     ll.push_back(2);
//     ll.push_back(3);
//     ll.push_back(4);

//     // printll(ll);
//     // cout << ll.size() << endl;
//     // cout << ll.front() << endl;
//     // cout << ll.back() << endl;

//     // ll.pop_back();
//     // ll.pop_front();

//     // auto itr = ll.begin();
//     // ll.insert(itr, 100);
//     // printll(ll);

//     // auto itr = ll.begin();
//     // advance(itr, 2);
//     // ll.insert(itr, 100);
//     // printll(ll);

    



//     return 0;
// }


